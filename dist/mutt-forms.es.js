var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},classCallCheck=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},createClass=function(){function defineProperties(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(t,e,r){return e&&defineProperties(t.prototype,e),r&&defineProperties(t,r),t}}(),inherits=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)},possibleConstructorReturn=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e},Validator=function(){function Validator(t){classCallCheck(this,Validator),this.error=null,this.messages={required:"This field is required."},Object.assign(this.messages,t)}return Validator.prototype.validate=function validate(t){return!0},Validator}(),RequiredValidator=function(t){function RequiredValidator(){return classCallCheck(this,RequiredValidator),possibleConstructorReturn(this,t.apply(this,arguments))}return inherits(RequiredValidator,t),RequiredValidator.prototype.validate=function validate(t){return!(!t&&0!==t)||(this.error=this.messages.required,!1)},RequiredValidator}(Validator),BooleanRequiredValidator=function(t){function BooleanRequiredValidator(){return classCallCheck(this,BooleanRequiredValidator),possibleConstructorReturn(this,t.apply(this,arguments))}return inherits(BooleanRequiredValidator,t),BooleanRequiredValidator.prototype.validate=function validate(t){return!0===t||!1===t||(this.error=this.messages.required,!1)},BooleanRequiredValidator}(Validator),BooleanTrueValidator=function(t){function BooleanTrueValidator(){return classCallCheck(this,BooleanTrueValidator),possibleConstructorReturn(this,t.apply(this,arguments))}return inherits(BooleanTrueValidator,t),BooleanTrueValidator.prototype.validate=function validate(t){return!0===t||(this.error=this.messages.required,!1)},BooleanTrueValidator}(Validator),LengthValidator=function(t){function LengthValidator(e){var r=e.min,i=void 0===r?null:r,n=e.max,o=void 0===n?null:n,s=e.messages,a=void 0===s?null:s;classCallCheck(this,LengthValidator);var l=possibleConstructorReturn(this,t.call(this,a));return l.min=i,l.max=o,l.messages.hasOwnProperty("minLength")||(l.messages.minLength="Length must be at least "+l.min+"!"),l.messages.hasOwnProperty("maxLength")||(l.messages.maxLength="Length must be no more than "+l.max+"!"),l}return inherits(LengthValidator,t),LengthValidator.prototype.validate=function validate(t){return t?this.min&&t.length<this.min?(this.error=this.messages.minLength,!1):!(this.max&&t.length>this.max)||(this.error=this.messages.maxLength,!1):(this.error=this.messages.required,!1)},LengthValidator}(Validator),IntegerValidator=function(t){function IntegerValidator(e){classCallCheck(this,IntegerValidator);var r=possibleConstructorReturn(this,t.call(this,e));return r.messages.hasOwnProperty("intRequired")||(r.messages.intRequired="Value must be an integer"),r}return inherits(IntegerValidator,t),IntegerValidator.prototype.validate=function validate(t){return!t||!isNaN(t)||(this.error=this.messages.intRequired,!1)},IntegerValidator}(Validator),RegexValidator=function(t){function RegexValidator(e,r){classCallCheck(this,RegexValidator);var i=possibleConstructorReturn(this,t.call(this,r));return i.pattern=e,i.messages.hasOwnProperty("invalidPattern")||(i.messages.invalidPattern="Value must match the pattern: "+i.pattern),i}return inherits(RegexValidator,t),RegexValidator.prototype.validate=function validate(t){return t?!!t.match(this.pattern)||(this.error=this.messages.invalidPattern,!1):(this.error=this.messages.required,!1)},RegexValidator}(Validator),Field=function(){function Field(t){var e=t.id,r=t.name,i=t.label,n=void 0===i?null:i,o=t.initial,s=void 0===o?null:o,a=t.widget,l=void 0===a?null:a,u=t.validators,d=void 0===u?[]:u,h=t.attribs,p=void 0===h?{}:h,c=t.description,f=void 0===c?null:c,g=t.options,y=void 0===g?{}:g,b=t.order,m=void 0===b?null:b,v=t.parent,C=void 0===v?null:v;classCallCheck(this,Field),this.id=e,this.name=r,this.label=n,this.description=f,this.attribs=p,this.options=y,this.validators=d,this.sortOrder=m,this.locked=!1,this.parent=C,this.label||(this.label=this.name),this.initOptions();var F=this.getWidget();l&&(F=l),this.widget=new F(this,this.type,this.id,this.name,this.label,this.attribs,this.options,s),this._errors=[]}return Field.prototype.initOptions=function initOptions(){this.options.hasOwnProperty("order")&&(this.sortOrder=this.options.order),this.options.hasOwnProperty("label")&&(this.label=this.options.label),this.options.hasOwnProperty("description")&&(this.description=this.options.description)},Field.prototype.render=function render(){return this.widget.render()},Field.prototype.destroy=function destroy(){return this.widget.destroy()},Field.prototype.postRender=function postRender(){this.widget.postRender()},Field.prototype.validate=function validate(){this.refreshValidationState();var t=this.value,e=this.validators,r=Array.isArray(e),i=0;for(e=r?e:e[Symbol.iterator]();;){var n;if(r){if(i>=e.length)break;n=e[i++]}else{if((i=e.next()).done)break;n=i.value}var o=n;if(!o.validate(t)){this.errors=o.error;break}}return!(this.errors.length>0)||(this.widget.refreshErrorState(this.errors),!1)},Field.prototype.lock=function lock(){return!this.locked&&(this.widget.lock(),this.locked=!0,!0)},Field.prototype.unlock=function unlock(){return!!this.locked&&(this.widget.unlock(),this.locked=!1,!0)},Field.prototype.refreshValidationState=function refreshValidationState(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this._errors=[],this.widget.errors=[],t&&this.widget.refreshErrorState([])},Field.prototype.getWidget=function getWidget(){return Mutt.config.getWidget("text")},Field.prototype.getSortOrder=function getSortOrder(){return this.sortOrder},Field.prototype.setSortOrder=function setSortOrder(t){this.sortOrder=t},Field.prototype.toString=function toString(){return"Field <"+this.name+" "+this.type+">"},Field.prototype.updateId=function updateId(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=this.id;this.id=t,e&&this.widget.updateId(r,t)},Field.prototype.updateName=function updateName(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.name=t,e&&this.widget.updateName(t)},Field.new=function _new(t,e,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,o=arguments.length>5&&void 0!==arguments[5]&&arguments[5],s={id:t,name:e,options:i,attribs:{},parent:n},a=null,l=[];if(r.description&&(s.description=r.description),r.title&&(s.label=r.title),r.default&&(s.initial=r.default),r.enum){var u=[],d=r.enum,h=Array.isArray(d),p=0;for(d=h?d:d[Symbol.iterator]();;){var c;if(h){if(p>=d.length)break;c=d[p++]}else{if((p=d.next()).done)break;c=p.value}var f=c;u.push([f,f])}s.choices=u,a=Mutt.config.getField("enum")}if(i.hasOwnProperty("hidden")&&i.hidden&&(s.widget=Mutt.config.getWidget("hidden")),r.format&&Mutt.config.hasWidget(r.format)&&(s.widget=Mutt.config.getWidget(r.format)),i.widget&&Mutt.config.hasWidget(i.widget)&&(s.widget=Mutt.config.getWidget(i.widget)),r.items&&(s.items=r.items),r.properties&&(s.properties=r.properties),(o||i.hasOwnProperty("required")&&i.required)&&("boolean"===r.type?l.push(new BooleanRequiredValidator):l.push(new RequiredValidator),s.attribs.required="true"),r.required&&(s.required=r.required),r.hasOwnProperty("minLength")&&l.push(new LengthValidator({min:r.minLength})),r.hasOwnProperty("maxLength")&&l.push(new LengthValidator({max:r.maxLength})),i.validators&&l.unshift.apply(l,i.validators),r.hasOwnProperty("minItems")&&(s.minItems=r.minItems),r.hasOwnProperty("maxItems")&&(s.maxItems=r.maxItems),s.validators=l,!a){if(!Mutt.config.hasField(r.type))return null;a=Mutt.config.getField(r.type)}return new a(s)},createClass(Field,[{key:"type",get:function get$$1(){var t=this.constructor.name.toLowerCase();return"field"!==t?t.replace("field",""):t},set:function set$$1(t){throw new Error("Unable to set type on a field instance!")}},{key:"value",get:function get$$1(){return this.widget.getValue()},set:function set$$1(t){this.widget.setValue(t)}},{key:"errors",get:function get$$1(){return this._errors},set:function set$$1(t){this._errors.push(t)}}]),Field}(),Fieldset=function(){function Fieldset(t){var e=t.label,r=void 0===e?null:e,i=t.name,n=void 0===i?null:i;classCallCheck(this,Fieldset),this.name=n,this.label=r,this.fields=[],this.errors={}}return Fieldset.prototype.addField=function addField(t){this.fields.push(t)},Fieldset.prototype.hasField=function hasField(t){for(var e in this.fields)if(e.name===t)return!0;return!1},Fieldset.prototype.data=function data(){var data={},t=this.fields,e=Array.isArray(t),r=0;for(t=e?t:t[Symbol.iterator]();;){var i;if(e){if(r>=t.length)break;i=t[r++]}else{if((r=t.next()).done)break;i=r.value}var n=i;data[n.name]=n.value}return data},Fieldset.prototype.populate=function populate(t){var e=this.fields,r=Array.isArray(e),i=0;for(e=r?e:e[Symbol.iterator]();;){var n;if(r){if(i>=e.length)break;n=e[i++]}else{if((i=e.next()).done)break;n=i.value}var o=n;t.hasOwnProperty(o.name)&&(o.value=t[o.name])}},Fieldset.prototype.validate=function validate(){var t=!0,e=this.fields,r=Array.isArray(e),i=0;for(e=r?e:e[Symbol.iterator]();;){var n;if(r){if(i>=e.length)break;n=e[i++]}else{if((i=e.next()).done)break;n=i.value}var o=n;o.validate()||(this.errors[o.name]=o.errors,t=!1)}return t},Fieldset.prototype.setFieldErrors=function setFieldErrors(t){for(var e in t)this.hasField(e)&&this.getField(e)},Fieldset.prototype.setLegend=function setLegend(t){this.label=t},Fieldset.prototype.refreshValidationState=function refreshValidationState(){this.errors={};var t=this.fields,e=Array.isArray(t),r=0;for(t=e?t:t[Symbol.iterator]();;){var i;if(e){if(r>=t.length)break;i=t[r++]}else{if((r=t.next()).done)break;i=r.value}i.refreshValidationState()}},Fieldset.prototype.render=function render(){var t=document.createDocumentFragment(),e=document.createElement("fieldset");if(e.classList.add("mutt-fieldset"),this.name&&e.setAttribute("name",this.name),this.label){var r=document.createElement("legend");r.textContent=this.label,e.appendChild(r)}this.fields.sort(function(t,e){return t.getSortOrder()-e.getSortOrder()});var i=this.fields,n=Array.isArray(i),o=0;for(i=n?i:i[Symbol.iterator]();;){var s;if(n){if(o>=i.length)break;s=i[o++]}else{if((o=i.next()).done)break;s=o.value}var a=s.render();e.appendChild(a)}return t.appendChild(e),t},Fieldset.prototype.postRender=function postRender(){var t=this.fields,e=Array.isArray(t),r=0;for(t=e?t:t[Symbol.iterator]();;){var i;if(e){if(r>=t.length)break;i=t[r++]}else{if((r=t.next()).done)break;i=r.value}i.postRender()}},Fieldset.prototype.lock=function lock(){var t=this.fields,e=Array.isArray(t),r=0;for(t=e?t:t[Symbol.iterator]();;){var i;if(e){if(r>=t.length)break;i=t[r++]}else{if((r=t.next()).done)break;i=r.value}i.lock()}},Fieldset.prototype.unlock=function unlock(){var t=this.fields,e=Array.isArray(t),r=0;for(t=e?t:t[Symbol.iterator]();;){var i;if(e){if(r>=t.length)break;i=t[r++]}else{if((r=t.next()).done)break;i=r.value}i.unlock()}},Fieldset.prototype.getFieldByPath=function getFieldByPath(t){var e=t.split("."),r=e.shift(),i=this.fields,n=Array.isArray(i),o=0;for(i=n?i:i[Symbol.iterator]();;){var s;if(n){if(o>=i.length)break;s=i[o++]}else{if((o=i.next()).done)break;s=o.value}var a=s;if(a.name===r){if(0===e.length)return a;if(a.constructor.prototype.hasOwnProperty("getFieldByPath"))return a.getFieldByPath(e.join("."))}}return null},Fieldset.new=function _new(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,o={name:i};t.hasOwnProperty("title")&&(o.label=t.title),e.hasOwnProperty("form")&&e.form.hasOwnProperty("label")&&(o.label=e.form.label),null!==n&&(o.label=n),Object.assign(o,e),t.hasOwnProperty("properties")&&(t=t.properties);var s=new Fieldset(o),a=1,l=Object.keys(t),u=Array.isArray(l),d=0;for(l=u?l:l[Symbol.iterator]();;){var h;if(u){if(d>=l.length)break;h=l[d++]}else{if((d=l.next()).done)break;h=d.value}var p=h,c=p+"_field_"+a,f=t[p],g={};if(!r||Object.keys(r).includes(p)){e.fields&&e.fields.hasOwnProperty(p)&&(g=e.fields[p]),e.fieldsets&&(g.fieldsets=e.fieldsets);var y=Field.new(c,p,f,g);y&&(y.getSortOrder()||y.setSortOrder(a),s.addField(y),a++)}}return s},Fieldset}(),MuttForm=function(){function MuttForm(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};classCallCheck(this,MuttForm),this.schema=t,this.options={},this.callbacks={},e&&e.hasOwnProperty("form")&&(this.options=e.form),this.mount=!1,this.multipart=!1,this.id=null,this.locked=!1,this.form=null,this.fieldsets=[],this.buttons={submit:null},this.build(t,e)}return MuttForm.prototype.build=function build(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(e.hasOwnProperty("fieldsets")){var r=0,i=e.fieldsets,n=Array.isArray(i),o=0;for(i=n?i:i[Symbol.iterator]();;){var s;if(n){if(o>=i.length)break;s=i[o++]}else{if((o=i.next()).done)break;s=o.value}var a=s,l=null,u=null;a.hasOwnProperty("fields")&&(l=a.fields),a.hasOwnProperty("fieldsets")&&(e.fieldsets=a.fieldsets),a.options&&a.options.hasOwnProperty("label")&&(u=a.options.label);var d=Fieldset.new(t,e,l,"mutt-fieldset-"+r,u);this.fieldsets.push(d),r++}}else{var h=Fieldset.new(t,e);this.fieldsets.push(h)}},MuttForm.prototype.data=function data(){if(arguments.length>0&&void 0!==arguments[0]&&arguments[0]){var t=[],e=this.fieldsets,r=Array.isArray(e),i=0;for(e=r?e:e[Symbol.iterator]();;){var n;if(r){if(i>=e.length)break;n=e[i++]}else{if((i=e.next()).done)break;n=i.value}var o=n;t.push(o.data())}return t}var data={},s=this.fieldsets,a=Array.isArray(s),l=0;for(s=a?s:s[Symbol.iterator]();;){var u;if(a){if(l>=s.length)break;u=s[l++]}else{if((l=s.next()).done)break;u=l.value}var d=u;data=Object.assign(data,d.data())}return data},MuttForm.prototype.populate=function populate(t){var e=this.fieldsets,r=Array.isArray(e),i=0;for(e=r?e:e[Symbol.iterator]();;){var n;if(r){if(i>=e.length)break;n=e[i++]}else{if((i=e.next()).done)break;n=i.value}n.populate(t)}},MuttForm.prototype.render=function render(t){var e=this;return this.mount=t,new Promise(function(t,r){var i=document.createDocumentFragment();e.form=document.createElement("form"),e.id&&e.form.setAttribute("id",e.id),e.form.setAttribute("method","POST"),e.form.setAttribute("action",""),e.form.setAttribute("class","mutt-form"),e.multipart&&e.form.setAttribute("enctype","multipart/form-data");var n=e.fieldsets,o=Array.isArray(n),s=0;for(n=o?n:n[Symbol.iterator]();;){var a;if(o){if(s>=n.length)break;a=n[s++]}else{if((s=n.next()).done)break;a=s.value}var l=a.render();e.form.appendChild(l)}var u="mutt-button",d="Submit";e.options.hasOwnProperty("buttons")&&e.options.buttons.hasOwnProperty("submit")&&(e.options.buttons.submit.hasOwnProperty("class")&&(u=u+" "+e.options.buttons.submit.class),e.options.buttons.submit.hasOwnProperty("text")&&(d=e.options.buttons.submit.text));var h=document.createElement("div");if(h.setAttribute("class","mutt-button-wrapper"),e.options.hasOwnProperty("buttons")){var p=Object.keys(e.options.buttons),c=Array.isArray(p),f=0;for(p=c?p:p[Symbol.iterator]();;){var g;if(c){if(f>=p.length)break;g=p[f++]}else{if((f=p.next()).done)break;g=f.value}var y=g;if("submit"!==y){var b=e.options.buttons[y],m=document.createElement("button");m.setAttribute("name",y),m.setAttribute("class",b.class),m.setAttribute("type","button"),m.textContent=b.text,m.onclick=b.callback,e.buttons[y]=m,h.appendChild(m)}}}var v=document.createElement("button");v.setAttribute("class",u),v.setAttribute("type","submit"),v.textContent=d,v.onclick=function(t){return e.submit(t),!1},e.buttons.submit=v,h.appendChild(v),e.form.appendChild(h),i.appendChild(e.form),e.mount.appendChild(i);var C=e.fieldsets,F=Array.isArray(C),A=0;for(C=F?C:C[Symbol.iterator]();;){var k;if(F){if(A>=C.length)break;k=C[A++]}else{if((A=C.next()).done)break;k=A.value}k.postRender()}t(e)})},MuttForm.prototype.destroy=function destroy(){if(this.mount){var t=this.mount.querySelector("form");return this.mount.removeChild(t),!0}return!1},MuttForm.prototype.validate=function validate(){var t=!0,e=[],r=this.fieldsets,i=Array.isArray(r),n=0;for(r=i?r:r[Symbol.iterator]();;){var o;if(i){if(n>=r.length)break;o=r[n++]}else{if((n=r.next()).done)break;o=n.value}var s=o;s.validate()||(e.push(s.errors),t=!1)}return Mutt.logger("Validation Complete -> Status: "+t+" -> "+JSON.stringify(e)),t},MuttForm.prototype.refreshValidationState=function refreshValidationState(){var t=this.fieldsets,e=Array.isArray(t),r=0;for(t=e?t:t[Symbol.iterator]();;){var i;if(e){if(r>=t.length)break;i=t[r++]}else{if((r=t.next()).done)break;i=r.value}i.refreshValidationState()}},MuttForm.prototype.submit=function submit(t){var e=!1;try{e=this.validate()}catch(t){return Mutt.logger("Unable to validate prior to submit!",t),!1}return!!e&&(Mutt.logger("Submit form"),this.callbacks.hasOwnProperty("submit")?this.callbacks.submit(this.data(),t):this.form.submit(),!0)},MuttForm.prototype.lock=function lock(){Mutt.log("Locking form");var t=this.fieldsets,e=Array.isArray(t),r=0;for(t=e?t:t[Symbol.iterator]();;){var i;if(e){if(r>=t.length)break;i=t[r++]}else{if((r=t.next()).done)break;i=r.value}i.lock()}},MuttForm.prototype.unlock=function unlock(){Mutt.log("Unlocking form");var t=this.fieldsets,e=Array.isArray(t),r=0;for(t=e?t:t[Symbol.iterator]();;){var i;if(e){if(r>=t.length)break;i=t[r++]}else{if((r=t.next()).done)break;i=r.value}i.unlock()}},MuttForm.prototype.on=function on(t,e){return this.callbacks[t]=e,this},MuttForm.prototype.setFormId=function setFormId(t){this.id=t},MuttForm.prototype.getFormId=function getFormId(){return this.id},MuttForm.prototype.setFieldErrors=function setFieldErrors(t){var e=this.fieldsets,r=Array.isArray(e),i=0;for(e=r?e:e[Symbol.iterator]();;){var n;if(r){if(i>=e.length)break;n=e[i++]}else{if((i=e.next()).done)break;n=i.value}n.setFieldErrors(t)}},MuttForm.prototype.getFieldByPath=function getFieldByPath(t){var e=this.fieldsets,r=Array.isArray(e),i=0;for(e=r?e:e[Symbol.iterator]();;){var n;if(r){if(i>=e.length)break;n=e[i++]}else{if((i=e.next()).done)break;n=i.value}var o=n.getFieldByPath(t);if(o)return o}},MuttForm}(),ArrayField=function(t){function ArrayField(e){var r=e.id,i=e.name,n=e.label,o=void 0===n?null:n,s=e.initial,a=void 0===s?null:s,l=e.widget,u=void 0===l?null:l,d=e.validators,h=void 0===d?[]:d,p=e.attribs,c=void 0===p?{}:p,f=e.description,g=void 0===f?null:f,y=e.options,b=void 0===y?{}:y,m=e.order,v=void 0===m?null:m,C=e.parent,F=void 0===C?null:C,A=e.items,k=void 0===A?{}:A,I=e.minItems,w=void 0===I?1:I,x=e.maxItems,S=void 0===x?null:x;classCallCheck(this,ArrayField);var E=possibleConstructorReturn(this,t.call(this,{id:r,name:i,label:o,initial:a,widget:u,validators:h,attribs:c,description:g,options:b,order:v,parent:F}));E.minItems=w,E.maxItems=S>w?S:w,E.itemSchema=k,E.itemOptions=b,E.slots=[];var O=!0;if(E.options.hasOwnProperty("disablePlaceholders")&&(O=!E.options.disablePlaceholders),O)for(var W in Array.from(Array(E.minItems).keys()))E.addSlot(!1);return E.validators.push(new LengthValidator({min:E.minItems,max:E.maxItems})),E._errors=[],E}return inherits(ArrayField,t),ArrayField.prototype.addSlot=function addSlot(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=this.slots.length+1,r=this.getSlotId(e),i=this.getSlotName(e),n=Object.assign({order:e},this.itemOptions),o=this.constructor.new(r,i,this.itemSchema,n,this);this.slots.push(o),t&&this.widget.hasOwnProperty("addSlot")&&this.widget.addSlot(o)},ArrayField.prototype.removeSlot=function removeSlot(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return 0!==this.slots.length&&(this.slots.pop(),t&&this.widget.hasOwnProperty("removeSlot")&&this.widget.removeSlot(),!0)},ArrayField.prototype.spliceSlot=function spliceSlot(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(0===this.slots.length)return!1;for(var r in this.slots)r=parseInt(r),e&&r===t&&this.slots[r].destroy();for(var i in this.slots.splice(t,1),this.slots){var n=parseInt(i)+1,o=this.getSlotId(n),s=this.getSlotName(n),a=this.slots[i];a.updateId(o,e),a.updateName(s,e)}return!0},ArrayField.prototype.getSlotId=function getSlotId(t){return this.id+"_item_"+t},ArrayField.prototype.getSlotName=function getSlotName(t){return this.name+"_"+t},ArrayField.prototype.validate=function validate(){if(this.refreshValidationState(),this.validators.length>0){var t=this.validators,e=Array.isArray(t),r=0;for(t=e?t:t[Symbol.iterator]();;){var i;if(e){if(r>=t.length)break;i=t[r++]}else{if((r=t.next()).done)break;i=r.value}var n=i;n.validate(this.value)||(this.errors=n.error)}}if(this.errors.length>0)return this.widget.refreshErrorState(this.errors),!1;var o=!0,s=this.slots,a=Array.isArray(s),l=0;for(s=a?s:s[Symbol.iterator]();;){var u;if(a){if(l>=s.length)break;u=s[l++]}else{if((l=s.next()).done)break;u=l.value}u.validate()||(o=!1)}return o},ArrayField.prototype.refreshValidationState=function refreshValidationState(){t.prototype.refreshValidationState.call(this),this._errors=[]},ArrayField.prototype.postRender=function postRender(){var t=this.slots,e=Array.isArray(t),r=0;for(t=e?t:t[Symbol.iterator]();;){var i;if(e){if(r>=t.length)break;i=t[r++]}else{if((r=t.next()).done)break;i=r.value}i.postRender()}},ArrayField.prototype.getWidget=function getWidget(){return Mutt.config.getWidget("array")},ArrayField.prototype.render=function render(){return this.widget.renderList(this.slots)},ArrayField.prototype.getFieldByPath=function getFieldByPath(t){var e=t.split("."),r=parseInt(e.shift());if(isNaN(r))return null;if(r>this.slots.length)return null;var i=this.slots[r];return 0===e.length?i:i.constructor.prototype.hasOwnProperty("getFieldByPath")?i.getFieldByPath(e.join(".")):null},createClass(ArrayField,[{key:"value",get:function get$$1(){var t=[],e=this.slots,r=Array.isArray(e),i=0;for(e=r?e:e[Symbol.iterator]();;){var n;if(r){if(i>=e.length)break;n=e[i++]}else{if((i=e.next()).done)break;n=i.value}var o=n;t.push(o.value)}return t},set:function set$$1(t){if(!Array.isArray(t))throw new Error("Unable to set array field value(s) from non-array!");if(t.length>this.slots.length){var e=t.length-this.slots.length,r=Array(e).keys(),i=Array.isArray(r),n=0;for(r=i?r:r[Symbol.iterator]();;){if(i){if(n>=r.length)break;r[n++]}else{if((n=r.next()).done)break;n.value}this.addSlot()}}else t.length<this.slots.length&&(this.slots=this.slots.slice(0,t.length));var o=this.slots.map(function(e,r){return[e,t[r]]}),s=Array.isArray(o),a=0;for(o=s?o:o[Symbol.iterator]();;){var l;if(s){if(a>=o.length)break;l=o[a++]}else{if((a=o.next()).done)break;l=a.value}var u=l,d=u[0],h=u[1];d.value=h}}}]),ArrayField}(Field),ButtonField=function(t){function ButtonField(){return classCallCheck(this,ButtonField),possibleConstructorReturn(this,t.apply(this,arguments))}return inherits(ButtonField,t),ButtonField.prototype.getWidget=function getWidget(){return Mutt.config.getWidget("button")},ButtonField}(Field);function toBool(t){if(void 0===t||null===t)return null;if("boolean"==typeof t)return t;switch(t.toLowerCase().trim()){case"true":case"yes":case"1":return!0;case"false":case"no":case"0":case null:return!1;default:return Boolean(t)}}var BooleanField=function(t){function BooleanField(){return classCallCheck(this,BooleanField),possibleConstructorReturn(this,t.apply(this,arguments))}return inherits(BooleanField,t),BooleanField.prototype.getWidget=function getWidget(){return Mutt.config.getWidget("checkbox")},createClass(BooleanField,[{key:"value",get:function get$$1(){return toBool(this.widget.getValue())},set:function set$$1(t){this.widget.setValue(t)}}]),BooleanField}(Field),ChoiceField=function(t){function ChoiceField(e){var r=e.id,i=e.name,n=e.label,o=void 0===n?null:n,s=e.initial,a=void 0===s?null:s,l=e.widget,u=void 0===l?null:l,d=e.validators,h=void 0===d?[]:d,p=e.attribs,c=void 0===p?{}:p,f=e.description,g=void 0===f?null:f,y=e.options,b=void 0===y?{}:y,m=e.order,v=void 0===m?null:m,C=e.parent,F=void 0===C?null:C,A=e.choices,k=void 0===A?[]:A;classCallCheck(this,ChoiceField);var I=possibleConstructorReturn(this,t.call(this,{id:r,name:i,label:o,initial:a,widget:u,validators:h,attribs:c,description:g,options:b,order:v,parent:F}));return I.choices=k,b.hasOwnProperty("choices")&&(I.choices=b.choices),I.widget.hasOwnProperty("setChoices")&&I.widget.setChoices(I.choices),I}return inherits(ChoiceField,t),ChoiceField.prototype.getWidget=function getWidget(){return this.options.hasOwnProperty("widget")&&"checkboxlist"===this.options.widget?Mutt.config.getWidget("checkboxlist"):Mutt.config.getWidget("select")},ChoiceField}(Field),IntegerField=function(t){function IntegerField(e){var r=e.id,i=e.name,n=e.label,o=void 0===n?null:n,s=e.initial,a=void 0===s?null:s,l=e.widget,u=void 0===l?null:l,d=e.validators,h=void 0===d?[]:d,p=e.attribs,c=void 0===p?{}:p,f=e.description,g=void 0===f?null:f,y=e.options,b=void 0===y?{}:y,m=e.order,v=void 0===m?null:m,C=e.parent,F=void 0===C?null:C;classCallCheck(this,IntegerField);var A=possibleConstructorReturn(this,t.call(this,{id:r,name:i,label:o,initial:a,widget:u,validators:h,attribs:c,description:g,options:b,order:v,parent:F}));return A.validators.push(new IntegerValidator),A}return inherits(IntegerField,t),IntegerField.prototype.getWidget=function getWidget(){return Mutt.config.getWidget("number")},createClass(IntegerField,[{key:"value",get:function get$$1(){var t=this.widget.getValue();return t||0===t?parseInt(t):""},set:function set$$1(t){this.widget.setValue(t)}}]),IntegerField}(Field),ObjectField=function(t){function ObjectField(e){var r=e.id,i=e.name,n=e.label,o=void 0===n?null:n,s=e.initial,a=void 0===s?null:s,l=e.widget,u=void 0===l?null:l,d=e.validators,h=void 0===d?[]:d,p=e.attribs,c=void 0===p?{}:p,f=e.description,g=void 0===f?null:f,y=e.options,b=void 0===y?{}:y,m=e.order,v=void 0===m?null:m,C=e.parent,F=void 0===C?null:C,A=e.properties,k=void 0===A?{}:A,I=e.required,w=void 0===I?[]:I;classCallCheck(this,ObjectField);var x=possibleConstructorReturn(this,t.call(this,{id:r,name:i,label:o,initial:a,widget:u,validators:h,attribs:c,description:g,options:b,order:v,parent:F}));x.object={};var S=1,E=Object.keys(k),O=Array.isArray(E),W=0;for(E=O?E:E[Symbol.iterator]();;){var V;if(O){if(W>=E.length)break;V=E[W++]}else{if((W=E.next()).done)break;V=W.value}var P=V,R=i+"_"+P,j={},B=!1;x.options.hasOwnProperty(P)&&(j=b[P]),w.length>0&&-1!==w.indexOf(P)&&(B=!0);var L=x.constructor.new(R,P,k[P],j,x,B);if(!L)throw new Error("Unable to create Field on ObjectField!");L.getSortOrder()||L.setSortOrder(S),x.object[P]=L,S++}return x._errors={},x}return inherits(ObjectField,t),ObjectField.prototype.validate=function validate(){var t=!0,e=Object.keys(this.object),r=Array.isArray(e),i=0;for(e=r?e:e[Symbol.iterator]();;){var n;if(r){if(i>=e.length)break;n=e[i++]}else{if((i=e.next()).done)break;n=i.value}var o=n,s=this.object[o];s.validate()||(this._errors[o]=s.errors,t=!1)}return t},ObjectField.prototype.refreshValidationState=function refreshValidationState(){t.prototype.refreshValidationState.call(this),this._errors={}},ObjectField.prototype.postRender=function postRender(){var t=Object.keys(this.object),e=Array.isArray(t),r=0;for(t=e?t:t[Symbol.iterator]();;){var i;if(e){if(r>=t.length)break;i=t[r++]}else{if((r=t.next()).done)break;i=r.value}var n=i;this.object[n].postRender()}},ObjectField.prototype.getWidget=function getWidget(){return Mutt.config.getWidget("object")},ObjectField.prototype.render=function render(){return this.widget.renderObject(this.object)},ObjectField.prototype.getFieldByPath=function getFieldByPath(t){var e=t.split("."),r=e.shift(),i=Object.keys(this.object),n=Array.isArray(i),o=0;for(i=n?i:i[Symbol.iterator]();;){var s;if(n){if(o>=i.length)break;s=i[o++]}else{if((o=i.next()).done)break;s=o.value}var a=s,l=this.object[a];if(l.name===r){if(0===e.length)return l;if(l.constructor.prototype.hasOwnProperty("getFieldByPath"))return l.getFieldByPath(e.join("."))}}return null},createClass(ObjectField,[{key:"value",get:function get$$1(){var t={},e=Object.keys(this.object),r=Array.isArray(e),i=0;for(e=r?e:e[Symbol.iterator]();;){var n;if(r){if(i>=e.length)break;n=e[i++]}else{if((i=e.next()).done)break;n=i.value}var o=n;t[o]=this.object[o].value}return t},set:function set$$1(t){if(t){if("object"!==(void 0===t?"undefined":_typeof(t)))throw new Error("Unable to set object field value(s) from non-object!");var e=Object.keys(t),r=Array.isArray(e),i=0;for(e=r?e:e[Symbol.iterator]();;){var n;if(r){if(i>=e.length)break;n=e[i++]}else{if((i=e.next()).done)break;n=i.value}var o=n;this.object.hasOwnProperty(o)&&(this.object[o].value=t[o])}}}},{key:"errors",get:function get$$1(){return this._errors},set:function set$$1(t){this._errors=t}}]),ObjectField}(Field),StringField=function(t){function StringField(){return classCallCheck(this,StringField),possibleConstructorReturn(this,t.apply(this,arguments))}return inherits(StringField,t),StringField.prototype.getWidget=function getWidget(){return Mutt.config.getWidget("text")},StringField}(Field),fields=Object.freeze({Field:Field,ArrayField:ArrayField,ButtonField:ButtonField,BooleanField:BooleanField,ChoiceField:ChoiceField,IntegerField:IntegerField,ObjectField:ObjectField,StringField:StringField}),Widget=function(){function Widget(t,e,r,i,n){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:{},a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;classCallCheck(this,Widget),this._field=t,this._rendered=!1,this.type=e,this.id=r,this.name=i,this.label=n,this.attribs=o,this.options=s,this.value=a,this.locked=!1,this.errors=[]}return Widget.prototype.render=function render(){var t=document.createDocumentFragment(),e=this.renderWrapper(),r=this.renderLabel(),i=this.renderField(),n=this.renderHelp(),o=this.renderErrors();return r&&e.appendChild(r),e.appendChild(i),n&&e.appendChild(n),o&&e.appendChild(o),t.appendChild(e),this._rendered=!0,t},Widget.prototype.destroy=function destroy(){var t=this.getElementWrapper();return t.parentNode.removeChild(t),!0},Widget.prototype.postRender=function postRender(){},Widget.prototype.lock=function lock(){if(this.locked)return!1;var t=this.getElementWrapper(),e=this.getElement();return t.removeChild(e),this.locked=!0,!0},Widget.prototype.unlock=function unlock(){if(!this.locked)return!1;var t=this.getElementWrapper(),e=this.getElement();t.removeChild(e);var r=this.renderField();return t.appendChild(r),this.locked=!1,!0},Widget.prototype.updateId=function updateId(t,e){this.getElementWrapper(t).id=e,this.id=e},Widget.prototype.updateName=function updateName(t){this.getElement().name=t,this.name=t},Widget.prototype.renderField=function renderField(){throw new Error("renderField should be overidden by a widget subclass!")},Widget.prototype.renderWrapper=function renderWrapper(){var t=document.createElement("div");return t.setAttribute("id",this.id),t.className=this.getFieldWrapperClass(),t},Widget.prototype.renderLabel=function renderLabel(){if(this.label){var t=document.createElement("label");return t.setAttribute("for",this.getFieldId()),t.setAttribute("class","mutt-label"),t.textContent=this.label,t}return null},Widget.prototype.renderHelp=function renderHelp(){if(this.options.hasOwnProperty("help")&&this.options.help){var t=document.createElement("span");return t.setAttribute("class","mutt-help"),t.textContent=this.options.help,t}return null},Widget.prototype.renderErrors=function renderErrors(){if(this.errors.length>0){var t=document.createElement("ul");t.className=this.getErrorClass();var e=this.errors,r=Array.isArray(e),i=0;for(e=r?e:e[Symbol.iterator]();;){var n;if(r){if(i>=e.length)break;n=e[i++]}else{if((i=e.next()).done)break;n=i.value}var o=n,s=document.createElement("li");s.textContent=o,t.appendChild(s)}return t}return null},Widget.prototype.refreshErrorState=function refreshErrorState(t){if(this.errors=t,this._rendered){var e=this.getElementWrapper(),r=this.getElementError(),i=this.getErrorWrapperClass();if(r&&(e.classList.remove(i),e.removeChild(r)),this.errors.length>0){e.classList.add(i);var n=this.renderErrors();n&&e.appendChild(n)}}},Widget.prototype.getElementWrapper=function getElementWrapper(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return t||(t=this.id),document.querySelector("#"+t)},Widget.prototype.getElement=function getElement(){return this.getElementWrapper().querySelector(".mutt-field")},Widget.prototype.getElementError=function getElementError(){return this.getElementWrapper().querySelector(".mutt-error")},Widget.prototype.getElementLabel=function getElementLabel(){return this.getElementWrapper().querySelector(".mutt-label")},Widget.prototype.getValue=function getValue(){if(!this._rendered)return this.value;var t=this.getElement();if(!t)throw new Error("Unable to get element!");return this.value=t.value,this.value},Widget.prototype.setValue=function setValue(t){if(this.value=t,this._rendered){var e=this.getElement();e&&(e.value=this.value)}},Widget.prototype.getFieldClass=function getFieldClass(){return this.attribs.hasOwnProperty("class")?"mutt-field "+this.attribs.class:"mutt-field"},Widget.prototype.getFieldWrapperClass=function getFieldWrapperClass(){return"mutt-field-wrapper"},Widget.prototype.getErrorClass=function getErrorClass(){return"mutt-error"},Widget.prototype.getErrorWrapperClass=function getErrorWrapperClass(){return"mutt-error-wrapper"},Widget.prototype.getFieldId=function getFieldId(){return this.name},Widget}(),ArrayInput=function(t){function ArrayInput(){return classCallCheck(this,ArrayInput),possibleConstructorReturn(this,t.apply(this,arguments))}return inherits(ArrayInput,t),ArrayInput.prototype.renderList=function renderList(t){var e=document.createDocumentFragment(),r=this.renderWrapper();t.sort(function(t,e){return t.getSortOrder()-e.getSortOrder()});var i=t,n=Array.isArray(i),o=0;for(i=n?i:i[Symbol.iterator]();;){var s;if(n){if(o>=i.length)break;s=i[o++]}else{if((o=i.next()).done)break;s=o.value}var a=s.render();r.appendChild(a)}return e.appendChild(r),this._rendered=!0,e},ArrayInput.prototype.render=function render(){throw new Error("ArrayInput must render as a list - use renderList")},ArrayInput.prototype.renderLabel=function renderLabel(){throw new Error("ArrayInput does not support a label!")},ArrayInput.prototype.getFieldClass=function getFieldClass(){return"mutt-field mutt-field-array"},ArrayInput.prototype.getElement=function getElement(){throw new Error("Unable to get element on an array field!")},ArrayInput.prototype.getElementByIndex=function getElementByIndex(t){return this.getElementWrapper().querySelector("#"+this.id+"_item_"+t)},ArrayInput.prototype.addSlot=function addSlot(t){var e=t.render();this.getElementWrapper().appendChild(e),t.postRender()},ArrayInput.prototype.removeSlot=function removeSlot(){var t=this._field.slots.length,e=this.getElementByIndex(t);this.getElementWrapper().removeChild(e)},ArrayInput.prototype.spliceSlot=function spliceSlot(t){var e=this.getElementByIndex(t);this.getElementWrapper().removeChild(e)},ArrayInput}(Widget),ButtonWidget=function(t){function ButtonWidget(){return classCallCheck(this,ButtonWidget),possibleConstructorReturn(this,t.apply(this,arguments))}return inherits(ButtonWidget,t),ButtonWidget.prototype.renderField=function renderField(){var t=document.createElement("button");for(var e in t.setAttribute("type","button"),t.setAttribute("class",this.getFieldClass()),this.attribs)t.setAttribute(e,this.attribs[e]);return t},ButtonWidget.prototype.getFieldClass=function getFieldClass(){return"mutt-field mutt-field-button"},ButtonWidget}(Widget),CheckboxInput=function(t){function CheckboxInput(){return classCallCheck(this,CheckboxInput),possibleConstructorReturn(this,t.apply(this,arguments))}return inherits(CheckboxInput,t),CheckboxInput.prototype.renderField=function renderField(){var t=this,e=document.createElement("input");for(var r in e.setAttribute("name",this.name),e.setAttribute("id",this.getFieldId()),e.setAttribute("type","checkbox"),e.setAttribute("class",this.getFieldClass()),e.onchange=function(){t.setValue(!e.hasAttribute("checked"))},this.value&&e.setAttribute("checked","checked"),this.attribs)e.setAttribute(r,this.attribs[r]);return this._rendered=!0,e},CheckboxInput.prototype.getValue=function getValue(){return this._rendered?!!this.getElement().hasAttribute("checked"):this.value},CheckboxInput.prototype.setValue=function setValue(t){if(this.value=t,this._rendered){var e=this.getElement();if(e){var r=this.getElementLabel();this.value?(e.setAttribute("checked","checked"),r&&r.classList.add("mutt-field-checkbox-checked")):(e.removeAttribute("checked"),r&&r.classList.remove("mutt-field-checkbox-checked"))}}},CheckboxInput.prototype.getFieldClass=function getFieldClass(){return"mutt-field mutt-field-checkbox"},CheckboxInput.prototype.getFieldId=function getFieldId(){return this.id+"-checkbox"},CheckboxInput}(Widget),CheckboxList=function(t){function CheckboxList(e,r,i,n,o,s,a,l){classCallCheck(this,CheckboxList);var u=possibleConstructorReturn(this,t.call(this,e,r,i,n,o,s,a,l));return u.value||(u.value=[]),u}return inherits(CheckboxList,t),CheckboxList.prototype.renderField=function renderField(){var t=this,e=document.createElement("ul");e.setAttribute("id",this.getFieldId());var r=function _loop(r){var i=document.createElement("li"),n=document.createElement("input");if(n.setAttribute("type","checkbox"),n.setAttribute("name",t.name),n.setAttribute("class",t.getFieldClass()),n.setAttribute("data-index",r),n.setAttribute("id",t.id+r),t.options.hasOwnProperty("choices")&&t.options.choices[r][1]){var o=document.createElement("label");o.setAttribute("for",t.id+r),o.textContent=t.options.choices[r][1],i.appendChild(o)}for(var s in n.onchange=function(){t.setValueByIndex(!n.hasAttribute("checked"),n.getAttribute("data-index"))},t.value&&t.value[r]&&n.setAttribute("checked","checked"),t.attribs)n.setAttribute(s,t.attribs[s]);i.appendChild(n),e.appendChild(i)};for(var i in this.choices)r(i);return this._rendered=!0,e},CheckboxList.prototype.getValueByIndex=function getValueByIndex(t){if(!this._rendered)return this.value[t];var e=this.getElementByIndex(t);if(!e)throw new Error("Unable to get element!");return e.hasAttribute("checked")?this.value=!0:this.value=!1,this.value},CheckboxList.prototype.getValue=function getValue(){if(!this._rendered)return this.value;var t=this.getAllElements();if(!t)throw new Error("Unable to get elements!");for(var e in Array.from(t))t[e].hasAttribute("checked")?this.value[e]=!0:this.value[e]=!1;return this.value},CheckboxList.prototype.setValueByIndex=function setValueByIndex(t,e){if(this.value[e]=t,this._rendered){var r=this.getElementByIndex(e);r&&(this.value[e]?r.setAttribute("checked","checked"):r.removeAttribute("checked"))}},CheckboxList.prototype.setValue=function setValue(t){if(this.value=t,this._rendered){var e=this.getAllElements();if(t.length!==e.length)throw new Error("Array Length does not match number of Elements in CheckboxList");for(var r in e[0].setAttribute("checked","checked"),Array.from(e))this.value[r]?e[parseInt(r)].setAttribute("checked","checked"):e[parseInt(r)].removeAttribute("checked")}},CheckboxList.prototype.setChoices=function setChoices(t){for(var e in t)this.value&&void 0===this.value[e]&&(this.value[e]=!1);this.choices=t},CheckboxList.prototype.getFieldId=function getFieldId(){return this.id+"-checkbox"},CheckboxList.prototype.getChoices=function getChoices(){return this.choices},CheckboxList.prototype.getAllElements=function getAllElements(){return this.getElementWrapper().querySelectorAll(".mutt-field")},CheckboxList.prototype.getElementByIndex=function getElementByIndex(t){return this.getElementWrapper().querySelectorAll(".mutt-field")[t]},CheckboxList}(CheckboxInput),BaseChoiceWidget=function(t){function BaseChoiceWidget(e,r,i,n,o,s,a,l){classCallCheck(this,BaseChoiceWidget);var u=possibleConstructorReturn(this,t.call(this,e,r,i,n,o,s,a,l));return u.choices=[],u}return inherits(BaseChoiceWidget,t),BaseChoiceWidget.prototype.setChoices=function setChoices(t){this.choices=t},BaseChoiceWidget.prototype.getChoices=function getChoices(){return this.choices},BaseChoiceWidget.prototype.formatLabel=function formatLabel(t){return t?""+(t=t.toLowerCase().replace("_"," ")).charAt(0).toUpperCase()+t.slice(1):t},BaseChoiceWidget.prototype.renderField=function renderField(){throw new Error("Unable to render abstract widget BaseChoiceInput!")},BaseChoiceWidget}(Widget),DateInput=function(t){function DateInput(){return classCallCheck(this,DateInput),possibleConstructorReturn(this,t.apply(this,arguments))}return inherits(DateInput,t),DateInput.prototype.renderField=function renderField(){var t=document.createElement("input");if(t.setAttribute("name",this.name),t.setAttribute("type","date"),t.setAttribute("value",this.value?this.value:""),t.setAttribute("class",this.getFieldClass()),this.options.hasOwnProperty("min"))if("now"===this.options.min){var e=new Date;t.setAttribute("min",e.toISOString().slice(0,-14))}else t.setAttribute("min",this.options.min);for(var r in this.attribs)t.setAttribute(r,this.attribs[r]);return t},DateInput.prototype.getFieldClass=function getFieldClass(){return"mutt-field mutt-field-date"},DateInput}(Widget),DateSelectionInput=function(t){function DateSelectionInput(e,r,i,n,o){var s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:{},l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;classCallCheck(this,DateSelectionInput);var u=possibleConstructorReturn(this,t.call(this,e,r,i,n,o,s,a,null));return u.setDateValue(l),u}return inherits(DateSelectionInput,t),DateSelectionInput.prototype.renderField=function renderField(){var t=document.createElement("div");t.setAttribute("class","mutt-date-selector");var e=this.getDateValue(),r=document.createElement("input");r.setAttribute("name",this.name),r.setAttribute("type","hidden"),r.setAttribute("value",this.value?this.value:""),t.appendChild(r);var i=document.createElement("select");i.setAttribute("name",this.name+"-day");var n=Array.from(Array(31).keys()),o=Array.isArray(n),s=0;for(n=o?n:n[Symbol.iterator]();;){var a;if(o){if(s>=n.length)break;a=n[s++]}else{if((s=n.next()).done)break;a=s.value}var l=a+1,u=document.createElement("option");u.setAttribute("value",("0"+l).slice(-2)),u.textContent=l,null!==e&&e.getDate()===l&&(u.selected="selected"),i.appendChild(u)}t.appendChild(i);var d=document.createElement("select");d.setAttribute("name",this.name+"-month");var h=this.getMonthNames();for(var p in h){var c=h[p],f=document.createElement("option"),g=parseInt(p)+1;g=("0"+g).slice(-2),f.setAttribute("value",g),f.textContent=c,null!==e&&e.getMonth()===parseInt(p)&&(f.selected="selected"),d.appendChild(f)}t.appendChild(d);var y=document.createElement("select");y.setAttribute("name",this.name+"-year");var b=(new Date).getFullYear(),m=b,v=20;for(this.options.hasOwnProperty("years")&&(v=this.options.years);m>b-v;){var C=document.createElement("option");C.setAttribute("value",m),C.textContent=m,null!==e&&e.getFullYear()===m&&(C.selected="selected"),y.appendChild(C),m--}return t.appendChild(y),t},DateSelectionInput.prototype.getFieldClass=function getFieldClass(){return"mutt-field mutt-field-date-selector"},DateSelectionInput.prototype.getElementDay=function getElementDay(){return this.getElementWrapper().querySelector('[name="'+this.name+'-day"]')},DateSelectionInput.prototype.getElementMonth=function getElementMonth(){return this.getElementWrapper().querySelector('[name="'+this.name+'-month"]')},DateSelectionInput.prototype.getElementYear=function getElementYear(){return this.getElementWrapper().querySelector('[name="'+this.name+'-year"]')},DateSelectionInput.prototype.getMonthNames=function getMonthNames(){return["January","February","March","April","May","June","July","August","September","October","November","December"]},DateSelectionInput.prototype.getDateValue=function getDateValue(){if(!this._rendered)return this.value;var t=this.getElementDay(),e=this.getElementMonth(),r=this.getElementYear();if(!t||!e||!r)throw new Error("Unable to get element for date!");var i=r.value+"-"+e.value+"-"+t.value,n=Date.parse(i);if(isNaN(n))return this.value=null,this.value;var o=new Date(n);return this.value=o,this.value},DateSelectionInput.prototype.setDateValue=function setDateValue(t){if("string"==typeof t){var e=Date.parse(t);if(isNaN(e))return;t=new Date(e)}if(this.value=t,this._rendered){var r=this.getElementDay(),i=this.getElementMonth(),n=this.getElementYear(),o=t.getDate();1===o.toString().length&&(o="0"+o);var s=t.getMonth()+1;1===s.toString().length&&(s="0"+s),r&&i&&n&&(r.value=o,i.value=s,n.value=this.value.getFullYear())}},DateSelectionInput.prototype.getValue=function getValue(){return this.getDateValue()},DateSelectionInput.prototype.setValue=function setValue(t){this.setDateValue(t)},DateSelectionInput}(Widget),NumberInput=function(t){function NumberInput(){return classCallCheck(this,NumberInput),possibleConstructorReturn(this,t.apply(this,arguments))}return inherits(NumberInput,t),NumberInput.prototype.renderField=function renderField(){var t=document.createElement("input");for(var e in t.setAttribute("name",this.name),t.setAttribute("type","number"),t.setAttribute("inputmode","numeric"),t.setAttribute("class",this.getFieldClass()),t.setAttribute("value",null!==this.value?this.value:""),t.setAttribute("pattern","[0-9]*"),this.attribs)t.setAttribute(e,this.attribs[e]);return t},NumberInput.prototype.getFieldClass=function getFieldClass(){return"mutt-field mutt-field-number"},NumberInput}(Widget),CurrencyInput=function(t){function CurrencyInput(){return classCallCheck(this,CurrencyInput),possibleConstructorReturn(this,t.apply(this,arguments))}return inherits(CurrencyInput,t),CurrencyInput.prototype.renderField=function renderField(){var t=document.createElement("input");for(var e in t.setAttribute("name",this.name),t.setAttribute("type","number"),t.setAttribute("inputmode","numeric"),t.setAttribute("class",this.getFieldClass()),t.setAttribute("value",null!==this.value?this.value:""),t.setAttribute("pattern","[0-9]*"),this.attribs)t.setAttribute(e,this.attribs[e]);return t},CurrencyInput.prototype.getValue=function getValue(){var e=t.prototype.getValue.call(this);return e&&(e=(e=parseFloat(e)).toFixed(2)),parseFloat(e)},CurrencyInput.prototype.getFieldClass=function getFieldClass(){return"mutt-field mutt-field-currency"},CurrencyInput}(Widget),ObjectInput=function(t){function ObjectInput(){return classCallCheck(this,ObjectInput),possibleConstructorReturn(this,t.apply(this,arguments))}return inherits(ObjectInput,t),ObjectInput.prototype.renderObjectFields=function renderObjectFields(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=[],n=Object.keys(e),o=Array.isArray(n),s=0;for(n=o?n:n[Symbol.iterator]();;){var a;if(o){if(s>=n.length)break;a=n[s++]}else{if((s=n.next()).done)break;a=s.value}var l=a;if(!r||Object.keys(r).includes(l)){var u=e[l];i.push([u.getSortOrder(),l])}}i.sort(function(t,e){return t[0]-e[0]});var d=i,h=Array.isArray(d),p=0;for(d=h?d:d[Symbol.iterator]();;){var c;if(h){if(p>=d.length)break;c=d[p++]}else{if((p=d.next()).done)break;c=p.value}var f=e[c[1]].render();t.appendChild(f)}},ObjectInput.prototype.renderObject=function renderObject(t){var e=document.createDocumentFragment(),r=this.renderWrapper();if(this.options.fieldsets){var i=0,n=this.options.fieldsets,o=Array.isArray(n),s=0;for(n=o?n:n[Symbol.iterator]();;){var a;if(o){if(s>=n.length)break;a=n[s++]}else{if((s=n.next()).done)break;a=s.value}var l=a,u=document.createElement("fieldset");if(u.classList.add("mutt-fieldset"),u.setAttribute("name",this.name+"-fieldset-"+i),l.hasOwnProperty("options")&&l.options.hasOwnProperty("class")&&l.options.class)if(l.options.class.includes(" ")){var d=l.options.class.split(" "),h=Array.isArray(d),p=0;for(d=h?d:d[Symbol.iterator]();;){var c;if(h){if(p>=d.length)break;c=d[p++]}else{if((p=d.next()).done)break;c=p.value}var f=c;u.classList.add(f)}}else u.classList.add(l.options.class);this.renderObjectFields(u,t,l.fields),r.appendChild(u),i++}}else this.renderObjectFields(r,t);return e.appendChild(r),this._rendered=!0,e},ObjectInput.prototype.render=function render(){throw new Error("ObjectInput must render as a object - use renderObject")},ObjectInput.prototype.renderLabel=function renderLabel(){throw new Error("ObjectInput does not support a label!")},ObjectInput.prototype.getFieldClass=function getFieldClass(){return"mutt-field mutt-field-object"},ObjectInput}(Widget),RadioInput=function(t){function RadioInput(e,r,i,n,o,s,a,l){classCallCheck(this,RadioInput);var u=possibleConstructorReturn(this,t.call(this,e,r,i,n,o,s,a,l));return"boolean"===u.type&&(a.hasOwnProperty("choices")?u.choices=a.choices:u.choices=[[!0,"Yes"],[!1,"No"]]),u}return inherits(RadioInput,t),RadioInput.prototype.renderField=function renderField(){var t=this,e=document.createElement("div"),r=0,i=this.choices,n=Array.isArray(i),o=0;for(i=n?i:i[Symbol.iterator]();;){var s;if(n){if(o>=i.length)break;s=i[o++]}else{if((o=i.next()).done)break;s=o.value}var a=s,l=a[0],u=a[1],d=this.id+"_"+r,h=document.createElement("div");h.setAttribute("class","mutt-field-radio-item");var p=document.createElement("input");if(p.setAttribute("id",d),p.setAttribute("type","radio"),p.setAttribute("name",this.id),p.setAttribute("value",l),p.setAttribute("class",this.getFieldClass()),this.options.hasOwnProperty("callback")&&(p.onclick=function(){return t.options.callback(t)}),this.attribs)for(var c in this.attribs)p.setAttribute(c,this.attribs[c]);this.value===l&&p.setAttribute("checked","checked");var f=document.createElement("label");f.setAttribute("for",d),f.textContent=this.formatLabel(u),h.appendChild(p),h.appendChild(f),e.appendChild(h),r++}return e},RadioInput.prototype.getRadioValue=function getRadioValue(){var t=this.getElementWrapper().querySelector(".mutt-field:checked");return t?(this.value=t.value,this.value):null},RadioInput.prototype.getValue=function getValue(){return this.getRadioValue()},RadioInput.prototype.getFieldClass=function getFieldClass(){return"mutt-field mutt-field-radio"},RadioInput}(BaseChoiceWidget),SelectInput=function(t){function SelectInput(){return classCallCheck(this,SelectInput),possibleConstructorReturn(this,t.apply(this,arguments))}return inherits(SelectInput,t),SelectInput.prototype.renderField=function renderField(){var t=document.createElement("select");for(var e in t.setAttribute("name",this.name),t.setAttribute("class",this.getFieldClass()),this.attribs)t.setAttribute(e,this.attribs[e]);var r=this.choices,i=Array.isArray(r),n=0;for(r=i?r:r[Symbol.iterator]();;){var o;if(i){if(n>=r.length)break;o=r[n++]}else{if((n=r.next()).done)break;o=n.value}var s=o,a=s[0],l=s[1],u=document.createElement("option");u.value=a,u.textContent=this.formatLabel(l),this.value===a&&u.setAttribute("selected","selected"),t.appendChild(u)}return t},SelectInput.prototype.getFieldClass=function getFieldClass(){return"mutt-field mutt-field-select"},SelectInput}(BaseChoiceWidget),TextInput=function(t){function TextInput(){return classCallCheck(this,TextInput),possibleConstructorReturn(this,t.apply(this,arguments))}return inherits(TextInput,t),TextInput.prototype.renderField=function renderField(){var t=document.createElement("input");for(var e in t.setAttribute("name",this.name),t.setAttribute("type","text"),t.setAttribute("value",this.value?this.value:""),t.setAttribute("class",this.getFieldClass()),this.attribs)t.setAttribute(e,this.attribs[e]);return t},TextInput.prototype.getFieldClass=function getFieldClass(){return"mutt-field mutt-field-text"},TextInput}(Widget),TextAreaInput=function(t){function TextAreaInput(){return classCallCheck(this,TextAreaInput),possibleConstructorReturn(this,t.apply(this,arguments))}return inherits(TextAreaInput,t),TextAreaInput.prototype.renderField=function renderField(){var t=document.createElement("textarea");for(var e in t.setAttribute("name",this.name),t.setAttribute("class",this.getFieldClass()),t.textContent=this.value?this.value:"",this.attribs)t.setAttribute(e,this.attribs[e]);return t},TextAreaInput.prototype.getFieldClass=function getFieldClass(){return"mutt-field mutt-field-text"},TextAreaInput}(Widget),EmailInput=function(t){function EmailInput(){return classCallCheck(this,EmailInput),possibleConstructorReturn(this,t.apply(this,arguments))}return inherits(EmailInput,t),EmailInput.prototype.renderField=function renderField(){var t=document.createElement("input");for(var e in t.setAttribute("name",this.name),t.setAttribute("type","email"),t.setAttribute("value",this.value?this.value:""),t.setAttribute("class",this.getFieldClass()),this.attribs)t.setAttribute(e,this.attribs[e]);return t},EmailInput.prototype.getFieldClass=function getFieldClass(){return"mutt-field mutt-field-email"},EmailInput}(TextInput),HiddenInput=function(t){function HiddenInput(e,r,i,n,o,s,a,l){classCallCheck(this,HiddenInput);var u=possibleConstructorReturn(this,t.call(this,e,r,i,n,o,s,a,l));return u.choices=[],u}return inherits(HiddenInput,t),HiddenInput.prototype.renderField=function renderField(){var t=document.createElement("input");for(var e in t.setAttribute("name",this.name),t.setAttribute("type","hidden"),t.setAttribute("value",this.value?this.value:""),t.setAttribute("class",this.getFieldClass()),this.attribs)t.setAttribute(e,this.attribs[e]);return t},HiddenInput.prototype.renderLabel=function renderLabel(){return null},HiddenInput.prototype.renderErrors=function renderErrors(){return null},HiddenInput.prototype.setChoices=function setChoices(t){this.choices=t},HiddenInput.prototype.getChoices=function getChoices(){return this.choices},HiddenInput}(Widget),PasswordInput=function(t){function PasswordInput(){return classCallCheck(this,PasswordInput),possibleConstructorReturn(this,t.apply(this,arguments))}return inherits(PasswordInput,t),PasswordInput.prototype.renderField=function renderField(){var t=document.createElement("input");for(var e in t.setAttribute("name",this.name),t.setAttribute("type","password"),t.setAttribute("value",this.value?this.value:""),t.setAttribute("class",this.getFieldClass()),this.attribs)t.setAttribute(e,this.attribs[e]);return t},PasswordInput.prototype.getFieldClass=function getFieldClass(){return"mutt-field mutt-field-password"},PasswordInput}(TextInput);function displayReadonlyValue(t){var e=document.createElement("span");return e.setAttribute("class","mutt-field mutt-field-display"),e.textContent=t,e}var DisplayWidget=function(t){function DisplayWidget(){return classCallCheck(this,DisplayWidget),possibleConstructorReturn(this,t.apply(this,arguments))}return inherits(DisplayWidget,t),DisplayWidget.prototype.renderField=function renderField(){return displayReadonlyValue(this.value)},DisplayWidget.prototype.getFieldClass=function getFieldClass(){return"mutt-field mutt-field-display"},DisplayWidget}(Widget),widgets=Object.freeze({Widget:Widget,ArrayInput:ArrayInput,ButtonWidget:ButtonWidget,CheckboxInput:CheckboxInput,CheckboxList:CheckboxList,BaseChoiceWidget:BaseChoiceWidget,DateInput:DateInput,DateSelectionInput:DateSelectionInput,NumberInput:NumberInput,CurrencyInput:CurrencyInput,ObjectInput:ObjectInput,RadioInput:RadioInput,SelectInput:SelectInput,TextInput:TextInput,TextAreaInput:TextAreaInput,EmailInput:EmailInput,HiddenInput:HiddenInput,PasswordInput:PasswordInput,DisplayWidget:DisplayWidget}),MuttConfig=function(){function MuttConfig(){classCallCheck(this,MuttConfig),this._config={settings:{debug:!1},fields:{array:ArrayField,boolean:BooleanField,enum:ChoiceField,integer:IntegerField,object:ObjectField,string:StringField,date:StringField,datetime:StringField,button:ButtonField},widgets:{array:ArrayInput,checkbox:CheckboxInput,checkboxlist:CheckboxList,date:DateInput,dateselect:DateSelectionInput,number:NumberInput,currency:CurrencyInput,object:ObjectInput,radio:RadioInput,select:SelectInput,text:TextInput,textarea:TextAreaInput,email:EmailInput,hidden:HiddenInput,password:PasswordInput,display:DisplayWidget,button:ButtonWidget}}}return MuttConfig.prototype.getSetting=function getSetting(t){return this._config.settings.hasOwnProperty(t)?this._config.settings[t]:null},MuttConfig.prototype.setSetting=function setSetting(t,e){this._config.settings[t]=e},MuttConfig.prototype.use=function use(t){if(!t.hasOwnProperty("install"))throw new Error("Unable to install plugin - missing install!");var e={},r=t.install();if(Array.isArray(r)){var i=r[0],n=r[1],o=r[2];e={fields:i,widgets:n,settings:o}}else e=r;e.fields&&this.registerFields(e.fields),e.widgets&&this.registerWidgets(e.widgets),e.settings&&(this._config.settings=Object.assign(this._config.settings,e.settings)),e.extensions&&Object.keys(e.extensions).forEach(function(t){var r=e.extensions[t];MuttForm.prototype[t]=r})},MuttConfig.prototype.registerField=function registerField(t,e){this._config.fields[t]=e},MuttConfig.prototype.registerFields=function registerFields(t){if(t){var e=Object.keys(t),r=Array.isArray(e),i=0;for(e=r?e:e[Symbol.iterator]();;){var n;if(r){if(i>=e.length)break;n=e[i++]}else{if((i=e.next()).done)break;n=i.value}var o=n;this.registerField(o,t[o])}}},MuttConfig.prototype.hasField=function hasField(t){return!!this._config.fields.hasOwnProperty(t)},MuttConfig.prototype.getField=function getField(t){return this._config.fields.hasOwnProperty(t)?this._config.fields[t]:null},MuttConfig.prototype.registerWidget=function registerWidget(t,e){this._config.widgets[t]=e},MuttConfig.prototype.registerWidgets=function registerWidgets(t){if(t){var e=Object.keys(t),r=Array.isArray(e),i=0;for(e=r?e:e[Symbol.iterator]();;){var n;if(r){if(i>=e.length)break;n=e[i++]}else{if((i=e.next()).done)break;n=i.value}var o=n;this.registerWidget(o,t[o])}}},MuttConfig.prototype.hasWidget=function hasWidget(t){return!!this._config.widgets.hasOwnProperty(t)},MuttConfig.prototype.getWidget=function getWidget(t){return this._config.widgets.hasOwnProperty(t)?this._config.widgets[t]:null},MuttConfig.prototype.getWidgets=function getWidgets(t){return this._config.widgets},MuttConfig}();function mixin(t,e){t=t.prototype,e=e.prototype,Object.getOwnPropertyNames(e).forEach(function(r){"constructor"!==r&&Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(e,r))})}function logger(t){Mutt.config.getSetting("debug")&&console.log("Mutt :: ",t)}var validators=Object.freeze({Validator:Validator,RequiredValidator:RequiredValidator,BooleanRequiredValidator:BooleanRequiredValidator,BooleanTrueValidator:BooleanTrueValidator,LengthValidator:LengthValidator,IntegerValidator:IntegerValidator,RegexValidator:RegexValidator});function Mutt(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(arguments.length>2&&void 0!==arguments[2]&&arguments[2]&&this.config.setSetting("debug",!0),void 0===t)throw new Error("You must specify a Schema!");return new MuttForm(t,e)}function initApi(t){var e=new MuttConfig;t.config=e,t.use=function(e){Array.isArray(e)||(e=[e]);var r=e,i=Array.isArray(r),n=0;for(r=i?r:r[Symbol.iterator]();;){var o;if(i){if(n>=r.length)break;o=r[n++]}else{if((n=r.next()).done)break;o=n.value}var s=o;t.config.use(s)}},t.logger=logger,t.mixin=mixin,t.fields=fields,t.widgets=widgets,t.validators=validators}initApi(Mutt),Mutt.version="1.8.0";export default Mutt;
